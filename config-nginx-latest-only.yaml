# Test configuration: nginx stable with only_latest_version
# Should reduce from 185 packages to ~15 packages

database:
  url: sqlite:///chantal-dev.db

storage:
  base_path: ./dev-storage
  pool_path: ./dev-storage/pool
  published_path: ./dev-storage/published

repositories:
  - id: nginx-latest-only
    name: nginx stable (latest versions only)
    type: rpm
    feed: https://nginx.org/packages/centos/9/x86_64/
    enabled: true

    # NEW: Generic filter structure with plugin-specific filters
    filters:
      # Generic metadata filters (all package types)
      metadata:
        architectures:
          include: ["x86_64"]  # Only x86_64, exclude i686

      # RPM-specific filters
      rpm:
        exclude_source_rpms: true  # No .src.rpm packages

      # Pattern filters (generic)
      patterns:
        exclude:
          - ".*-debuginfo$"     # No debuginfo packages
          - ".*-debugsource$"   # No debugsource packages

      # Post-processing (applied after filtering)
      post_processing:
        only_latest_version: true  # KEEP ONLY LATEST VERSION!
